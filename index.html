<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meow & 王朝密码</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-color: #FF0080;
            --secondary-color: #FF8C00;
            --accent-color: #40E0D0;
            --text-color: #333;
            --bg-color: #ffffff;
            --card-bg: #ffffff;
            --border-color: rgba(255,255,255,0.2);
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            --button-bg: linear-gradient(90deg, #FF0080, #FF8C00);
            --button-hover: linear-gradient(90deg, #FF4D94, #FFB347);
            --success-color: #66FF99;
            --dynasty-primary: #1a2a6c;
            --dynasty-secondary: #b21f1f;
            --dynasty-tertiary: #fdbb2d;
            --meow-gradient: linear-gradient(90deg, #FF0080, #FF8C00, #FFD400);
            --dynasty-gradient: linear-gradient(90deg, #1a2a6c, #b21f1f, #fdbb2d);
        }

        .dark-mode {
            --text-color: #f0e6ff;
            --bg-color: #121212;
            --card-bg: rgba(30, 10, 30, 0.9);
            --border-color: rgba(255,255,255,0.1);
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
            --button-bg: linear-gradient(90deg, #FF4D94, #FF8C42);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(125deg, 
                #FF0080, #FF512F, #FFD400, #40E0D0, #0093E9, #7A3DDA, #FF00FF);
            background-size: 300% 300%;
            animation: rainbow-gradient 12s ease infinite;
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        @keyframes rainbow-gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px 0;
        }

        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, 
                #FF0080, #FF8C00, #FFD400, #40E0D0, #0093E9, #7A3DDA, #FF00FF);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            animation: rainbow-text 10s ease infinite;
            background-size: 300% 300%;
        }

        @keyframes rainbow-text {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .description {
            color: white;
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 15px;
            border-radius: 20px;
            backdrop-filter: blur(5px);
        }

        /* 新增下载按钮样式 */
        .download-container {
            margin: 20px auto;
            max-width: 800px;
            text-align: center;
        }

        .download-btn {
            display: inline-block;
            padding: 16px 35px;
            border-radius: 50px;
            background: linear-gradient(90deg, 
                #FF0080, #FF512F, #FFD400, #40E0D0, #0093E9, #7A3DDA, #FF00FF);
            background-size: 300% 300%;
            animation: rainbow-text 8s ease infinite;
            color: white;
            font-weight: 700;
            font-size: 1.4rem;
            text-decoration: none;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
            margin: 15px 0;
        }

        .download-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            z-index: -1;
            transition: all 0.4s;
        }

        .download-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.4);
            animation: rainbow-text 4s ease infinite;
        }

        .download-btn i {
            margin-right: 10px;
            animation: float 2s ease-in-out infinite;
        }

        .download-btn span {
            position: relative;
            z-index: 2;
        }

        .download-btn:hover::before {
            background: rgba(255, 255, 255, 0.2);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-radius: 15px;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.2);
            max-width: 800px;
            margin: 0 auto 25px;
        }

        .tab {
            flex: 1;
            text-align: center;
            padding: 15px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.3);
            font-weight: 600;
            transition: all 0.3s;
            font-size: 1.1rem;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--meow-gradient);
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .tab[data-tab="dynasty"]::before {
            background: var(--dynasty-gradient);
        }

        .tab.active::before {
            opacity: 1;
        }

        .tab.active {
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
            font-size: 1.1rem;
        }

        textarea {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            background: var(--card-bg);
            color: var(--text-color);
            font-size: 1rem;
            resize: vertical;
            transition: all 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(64, 224, 208, 0.4);
        }

        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        button {
            padding: 14px 20px;
            border: none;
            border-radius: 10px;
            background: var(--button-bg);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--button-hover);
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s;
        }

        button:hover::before {
            opacity: 1;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }

        button i {
            margin-right: 8px;
        }

        .success {
            background: var(--success-color);
            color: #000;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            z-index: 100;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
        }

        .theme-toggle i {
            font-size: 1.5rem;
            color: white;
        }

        .result-container {
            margin-bottom: 15px;
        }

        .result-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 10px;
        }

        .copy-btn {
            padding: 12px 25px;
            background: var(--button-bg);
            color: white;
            font-weight: 600;
            border-radius: 8px;
            display: flex;
            align-items: center;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .copy-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--button-hover);
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .copy-btn:hover::before {
            opacity: 1;
        }

        .copy-btn:hover {
            transform: translateY(-2px);
        }

        .char-set {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
            padding: 15px;
            background: rgba(255,255,255,0.15);
            border-radius: 12px;
        }

        .char-set span {
            font-family: monospace;
            font-size: 1.1rem;
            padding: 5px 12px;
            background: rgba(255,255,255,0.2);
            border-radius: 6px;
            transition: all 0.3s;
        }

        .char-set span:hover {
            transform: translateY(-3px);
            background: rgba(255,255,255,0.3);
        }

        .dynasty-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }

        .dynasty-btn {
            flex: 1;
            min-width: 140px;
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15);
            color: white;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .dynasty-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .dynasty-btn-encrypt {
            background: linear-gradient(to right, #2193b0, #6dd5ed);
        }
        
        .dynasty-btn-encrypt::before {
            background: linear-gradient(to right, #1a2a6c, #2193b0);
        }
        
        .dynasty-btn-decrypt {
            background: linear-gradient(to right, #ff416c, #ff4b2b);
        }
        
        .dynasty-btn-decrypt::before {
            background: linear-gradient(to right, #b21f1f, #ff416c);
        }
        
        .dynasty-btn-clear {
            background: linear-gradient(to right, #8e9eab, #eef2f3);
            color: #333;
        }
        
        .dynasty-btn-clear::before {
            background: linear-gradient(to right, #fdbb2d, #eef2f3);
        }
        
        .dynasty-btn-copy {
            background: linear-gradient(to right, #5d8aa8, #7db9e8);
        }
        
        .dynasty-btn-copy::before {
            background: linear-gradient(to right, #1a2a6c, #5d8aa8);
        }

        .dynasty-btn:hover::before {
            opacity: 1;
        }

        .dynasty-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }

        footer {
            text-align: center;
            margin-top: 30px;
            color: rgba(255, 255, 255, 0.85);
            font-size: 1rem;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .honey-icon {
            display: inline-block;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
            100% { transform: translateY(0px); }
        }
        
        .dynasty-output-group {
            margin-top: 25px;
        }
        
        .dynasty-section-title {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .dynasty-section-title h3 {
            font-size: 1.4rem;
            background: var(--dynasty-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-left: 10px;
        }
        
        .dynasty-char-set {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 15px;
            padding: 15px;
            background: rgba(255,255,255,0.15);
            border-radius: 12px;
        }
        
        .dynasty-char-set span {
            font-family: monospace;
            font-size: 1.1rem;
            padding: 8px 10px;
            background: rgba(255,255,255,0.2);
            border-radius: 6px;
            text-align: center;
            transition: all 0.3s;
        }

        .dynasty-char-set span:hover {
            background: linear-gradient(90deg, rgba(26,42,108,0.3), rgba(178,31,31,0.3), rgba(253,187,45,0.3));
            transform: translateY(-3px);
        }
        
        .dynasty-char-set .zone-label {
            grid-column: 1 / -1;
            font-weight: bold;
            background: rgba(255,255,255,0.3);
            margin-top: 10px;
            margin-bottom: 5px;
            padding: 8px;
            border-radius: 6px;
            background: linear-gradient(90deg, rgba(26,42,108,0.3), rgba(178,31,31,0.3), rgba(253,187,45,0.3));
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .button-group, .result-buttons, .dynasty-buttons {
                flex-direction: column;
            }
            
            button, .copy-btn, .dynasty-btn {
                width: 100%;
            }
            
            .download-btn {
                padding: 14px 25px;
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <div class="theme-toggle" id="themeToggle">
        <i class="fas fa-moon"></i>
    </div>

    <div class="container">
        <header>
            <h1>Meow & 王朝密码</h1>
            <div class="download-container">
                <a href="https://www.123865.com/s/jE4Fjv-bsYeh" class="download-btn">
                    <i class="fas fa-download"></i>
                    <span>下载应用</span>
                </a>
            </div>
            <p class="description">
                <i class="fas fa-rainbow honey-icon"></i> 
                一站式体验
                <i class="fas fa-lock honey-icon"></i>
            </p>
        </header>

        <div class="tabs">
            <div class="tab active" data-tab="meow">Meow</div>
            <div class="tab" data-tab="dynasty">王朝密码</div>
        </div>

        <!-- 七彩加密部分 -->
        <div id="meow" class="tab-content active">
            <div class="card">
                <div class="input-group">
                    <label for="inputText"><i class="fas fa-pen"></i> 加点"七彩蜜"</label>
                    <textarea id="inputText" placeholder="输入你的甜蜜内容..."></textarea>
                </div>

                <div class="button-group">
                    <button id="encryptBtn"><i class="fas fa-lock"></i> 加点"蜜"</button>
                    <button id="decryptBtn"><i class="fas fa-lock-open"></i> 接点"蜜"</button>
                    <button id="clearBtn"><i class="fas fa-trash-alt"></i> 全部吃掉</button>
                </div>
            </div>

            <div class="card">
                <div class="input-group">
                    <label for="resultText"><i class="fas fa-key"></i> 接点"蜜"</label>
                    <div class="result-container">
                        <textarea id="resultText" readonly placeholder="甜蜜结果将在这里显示..."></textarea>
                    </div>
                </div>
                <div class="result-buttons">
                    <button class="copy-btn" id="copyBtn"><i class="fas fa-copy"></i> 传递甜蜜</button>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-honey-pot"></i> 支持的内容：</h3>
                <div class="char-set">
                    <span>A-Z</span>
                    <span>a-z</span>
                    <span>0-9</span>
                    <span>! @ # $ %</span>
                    <span>^ & * ( )</span>
                    <span>- _ + =</span>
                    <span>{ } [ ]</span>
                    <span>: ; " '</span>
                    <span>, . ? /</span>
                    <span>\ | ~ `</span>
                    <span>中文</span>
                </div>
            </div>
        </div>

        <!-- 王朝密码部分 -->
        <div id="dynasty" class="tab-content">
            <div class="card">
                <div class="input-group">
                    <label for="dynastyInputText"><i class="fas fa-pen"></i> 输入文本</label>
                    <textarea id="dynastyInputText" placeholder="请输入要加密的文本..."></textarea>
                </div>

                <div class="dynasty-buttons">
                    <button class="dynasty-btn dynasty-btn-encrypt" id="dynastyEncryptBtn">加密</button>
                    <button class="dynasty-btn dynasty-btn-decrypt" id="dynastyDecryptBtn">解密</button>
                    <button class="dynasty-btn dynasty-btn-clear" id="dynastyClearBtn">清空</button>
                    <button class="dynasty-btn dynasty-btn-copy" id="dynastyCopyInputBtn">复制输入</button>
                </div>
            </div>

            <div class="card">
                <div class="input-group">
                    <label for="dynastyOutputText"><i class="fas fa-key"></i> 加密/解密结果</label>
                    <div class="result-container">
                        <textarea id="dynastyOutputText" readonly placeholder="加密/解密结果将显示在这里..."></textarea>
                    </div>
                </div>
                <div class="result-buttons">
                    <button class="dynasty-btn dynasty-btn-copy" id="dynastyCopyOutputBtn">复制结果</button>
                </div>
            </div>
            
            <div class="card">
                <h3><i class="fas fa-key"></i> 王朝密码字符对照表</h3>
                <div class="dynasty-char-set">
                    <div class="zone-label">X 区</div>
                    <span>a → X1</span>
                    <span>b → X2</span>
                    <span>c → X3</span>
                    <span>d → X4</span>
                    <span>e → X5</span>
                    <span>f → X6</span>
                    <span>g → X7</span>
                    <span>h → X8</span>
                    <span>i → X9</span>
                    
                    <div class="zone-label">Y 区</div>
                    <span>j → Y1</span>
                    <span>k → Y2</span>
                    <span>l → Y3</span>
                    <span>m → Y4</span>
                    <span>n → Y5</span>
                    <span>o → Y6</span>
                    <span>p → Y7</span>
                    <span>q → Y8</span>
                    <span>r → Y9</span>
                    
                    <div class="zone-label">Z 区</div>
                    <span>s → Z1</span>
                    <span>t → Z2</span>
                    <span>u → Z3</span>
                    <span>v → Z4</span>
                    <span>w → Z5</span>
                    <span>x → Z6</span>
                    <span>y → Z7</span>
                    <span>z → Z8</span>
                    
                    <div class="zone-label">特殊功能</div>
                    <span>空格 → L5</span>
                    <span>大写 → L6</span>
                    <span>ā → L1</span>
                    <span>á → L2</span>
                    <span>ǎ → L3</span>
                    <span>à → L4</span>
                </div>
            </div>
        </div>

        <footer>
            <p>七彩密码 <i class="fas fa-rainbow honey-icon"></i> 王朝密码 <i class="fas fa-lock honey-icon"></i> 安全加密工具</p>
        </footer>
    </div>

    <script>
        // 切换主题
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = themeToggle.querySelector('i');
        
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            if (document.body.classList.contains('dark-mode')) {
                themeIcon.className = 'fas fa-sun';
            } else {
                themeIcon.className = 'fas fa-moon';
            }
        });

        // 选项卡切换
        const tabs = document.querySelectorAll('.tab');
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // 移除所有活动状态
                tabs.forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // 激活当前选项卡
                tab.classList.add('active');
                document.getElementById(tab.dataset.tab).classList.add('active');
            });
        });

        // ================= 七彩加密功能 =================
        function encrypt(text) {
            if (!text) return '';
            
            const meowSequence = ['m', 'e', 'o', 'w'];
            let result = '';
            let meowIndex = 0;
            
            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                const meowChar = meowSequence[meowIndex];
                
                // 获取字符的ASCII码
                const charCode = char.charCodeAt(0);
                
                // 应用meow字符的偏移量
                const offset = meowChar.charCodeAt(0) - 97; // a=97 in ASCII
                let newCharCode = charCode + offset;
                
                // 处理超出可打印字符范围的情况
                if (charCode >= 32 && charCode <= 126) {
                    // 可打印字符范围
                    while (newCharCode > 126) {
                        newCharCode = 32 + (newCharCode - 127);
                    }
                }
                
                result += String.fromCharCode(newCharCode);
                
                // 更新meow索引
                meowIndex = (meowIndex + 1) % meowSequence.length;
            }
            
            return result;
        }

        function decrypt(text) {
            if (!text) return '';
            
            const meowSequence = ['m', 'e', 'o', 'w'];
            let result = '';
            let meowIndex = 0;
            
            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                const meowChar = meowSequence[meowIndex];
                
                // 获取字符的ASCII码
                const charCode = char.charCodeAt(0);
                
                // 应用meow字符的偏移量（反向）
                const offset = meowChar.charCodeAt(0) - 97; // a=97 in ASCII
                let newCharCode = charCode - offset;
                
                // 处理超出可打印字符范围的情况
                if (charCode >= 32 && charCode <= 126) {
                    // 可打印字符范围
                    while (newCharCode < 32) {
                        newCharCode = 127 - (32 - newCharCode);
                    }
                }
                
                result += String.fromCharCode(newCharCode);
                
                // 更新meow索引
                meowIndex = (meowIndex + 1) % meowSequence.length;
            }
            
            return result;
        }

        // 七彩加密DOM元素
        const inputText = document.getElementById('inputText');
        const resultText = document.getElementById('resultText');
        const encryptBtn = document.getElementById('encryptBtn');
        const decryptBtn = document.getElementById('decryptBtn');
        const clearBtn = document.getElementById('clearBtn');
        const copyBtn = document.getElementById('copyBtn');

        // 七彩加密按钮事件
        encryptBtn.addEventListener('click', () => {
            const text = inputText.value;
            resultText.value = encrypt(text);
            showFeedback('加密成功!');
        });

        decryptBtn.addEventListener('click', () => {
            const text = inputText.value;
            resultText.value = decrypt(text);
            showFeedback('解密成功!');
        });

        clearBtn.addEventListener('click', () => {
            inputText.value = '';
            resultText.value = '';
            inputText.focus();
            showFeedback('内容已清空');
        });

        // 七彩加密复制按钮事件
        copyBtn.addEventListener('click', () => {
            if (resultText.value) {
                resultText.select();
                document.execCommand('copy');
                
                // 显示复制成功反馈
                const originalText = copyBtn.innerHTML;
                copyBtn.innerHTML = '<i class="fas fa-check"></i> 已复制甜蜜';
                copyBtn.classList.add('success');
                
                // 添加动画效果
                copyBtn.style.transform = 'scale(1.05)';
                setTimeout(() => {
                    copyBtn.style.transform = 'scale(1)';
                }, 300);
                
                setTimeout(() => {
                    copyBtn.innerHTML = originalText;
                    copyBtn.classList.remove('success');
                }, 2000);
                
                showFeedback('已复制到剪贴板');
            }
        });

        // ================= 王朝密码功能 =================
        // 字符到字区的映射
        const charToZone = {
            // X区
            'a': ['X', '1'], 'b': ['X', '2'], 'c': ['X', '3'], 'd': ['X', '4'], 'e': ['X', '5'],
            'f': ['X', '6'], 'g': ['X', '7'], 'h': ['X', '8'], 'i': ['X', '9'],
            // Y区
            'j': ['Y', '1'], 'k': ['Y', '2'], 'l': ['Y', '3'], 'm': ['Y', '4'], 'n': ['Y', '5'],
            'o': ['Y', '6'], 'p': ['Y', '7'], 'q': ['Y', '8'], 'r': ['Y', '9'],
            // Z区
            's': ['Z', '1'], 't': ['Z', '2'], 'u': ['Z', '3'], 'v': ['Z', '4'], 'ü': ['Z', '4'],
            'w': ['Z', '5'], 'x': ['Z', '6'], 'y': ['Z', '7'], 'z': ['Z', '8'],
            // M区 (数字倒序)
            '0': ['M', '0'], '1': ['M', '9'], '2': ['M', '8'], '3': ['M', '7'], '4': ['M', '6'],
            '5': ['M', '5'], '6': ['M', '4'], '7': ['M', '3'], '8': ['M', '2'], '9': ['M', '1'],
            // N区
            '，': ['N', '1'], '。': ['N', '2'], '？': ['N', '3'], '！': ['N', '4'],
            '@': ['N', '5'], '．': ['N', '6'], '"': ['N', '7'],
            // 空格
            ' ': ['L', '5']
        };

        // 声调映射
        const toneMap = {
            'ā': 'L1', 'á': 'L2', 'ǎ': 'L3', 'à': 'L4'
        };

        // 王朝密码加密
        function dynastyEncrypt(text) {
            if (!text) return '';
            
            let result = '';
            let currentZone = null;
            let inUpperCase = false;
            let uppercaseSequence = false;
            
            for (let i = 0; i < text.length; i++) {
                let char = text[i];
                
                // 处理大写字母
                if (/[A-Z]/.test(char)) {
                    if (!inUpperCase) {
                        result += 'L6';
                        inUpperCase = true;
                        uppercaseSequence = true;
                    }
                    char = char.toLowerCase();
                } else if (inUpperCase && /[^a-zA-Z]/.test(char)) {
                    result += 'L6';
                    inUpperCase = false;
                }
                
                // 处理带声调字符
                if (toneMap[char]) {
                    result += toneMap[char];
                    currentZone = null;
                    continue;
                }
                
                // 查找字符映射
                const mapping = charToZone[char] || 
                               charToZone[char.toLowerCase()] || 
                               [null, null];
                
                const [zone, seq] = mapping;
                
                if (zone && seq) {
                    // 同区优化
                    if (zone === currentZone && !uppercaseSequence) {
                        result += seq;
                    } else {
                        result += zone + seq;
                        currentZone = zone;
                    }
                    
                    // 结束大写序列
                    if (uppercaseSequence) {
                        uppercaseSequence = false;
                    }
                } else {
                    // 不在映射表中的字符直接保留
                    result += char;
                    currentZone = null;
                }
            }
            
            // 结束大写序列
            if (inUpperCase) {
                result += 'L6';
            }
            
            return result;
        }

        // 王朝密码解密
        function dynastyDecrypt(text) {
            if (!text) return '';
            
            let result = '';
            let i = 0;
            let currentZone = null;
            let inUpperCase = false;
            
            // 区号到字符的映射
            const zoneToChar = {
                'X': { 
                    '1': 'a', '2': 'b', '3': 'c', '4': 'd', '5': 'e',
                    '6': 'f', '7': 'g', '8': 'h', '9': 'i'
                },
                'Y': {
                    '1': 'j', '2': 'k', '3': 'l', '4': 'm', '5': 'n',
                    '6': 'o', '7': 'p', '8': 'q', '9': 'r'
                },
                'Z': {
                    '1': 's', '2': 't', '3': 'u', '4': 'v', '5': 'w',
                    '6': 'x', '7': 'y', '8': 'z'
                },
                'M': {
                    '0': '0', '1': '9', '2': '8', '3': '7', '4': '6',
                    '5': '5', '6': '4', '7': '3', '8': '2', '9': '1'
                },
                'N': {
                    '1': '，', '2': '。', '3': '？', '4': '！',
                    '5': '@', '6': '．', '7': '"'
                },
                'L': {
                    '1': 'ā', '2': 'á', '3': 'ǎ', '4': 'à', '5': ' ', 
                    '6': function() { inUpperCase = !inUpperCase; return ''; }
                }
            };
            
            while (i < text.length) {
                const char = text[i];
                
                // 处理L区控制符
                if (char === 'L') {
                    const nextChar = text[i + 1];
                    i += 2;
                    
                    if (nextChar === '5') {
                        result += ' ';
                    } else if (nextChar === '6') {
                        inUpperCase = !inUpperCase;
                    } else if (nextChar) {
                        const toneChar = zoneToChar['L'][nextChar];
                        if (toneChar) {
                            result += toneChar;
                        }
                    }
                    continue;
                }
                
                // 处理区号
                if (['X', 'Y', 'Z', 'M', 'N'].includes(char)) {
                    currentZone = char;
                    i++;
                    
                    // 处理区号后的数字序列
                    while (i < text.length && /\d/.test(text[i])) {
                        const seq = text[i];
                        i++;
                        
                        const charMap = zoneToChar[currentZone];
                        if (charMap && charMap[seq]) {
                            let decryptedChar = charMap[seq];
                            
                            // 处理大写转换
                            if (inUpperCase && typeof decryptedChar === 'string' && /[a-z]/.test(decryptedChar)) {
                                decryptedChar = decryptedChar.toUpperCase();
                            }
                            
                            result += decryptedChar;
                        }
                    }
                    continue;
                }
                
                // 处理普通字符
                result += char;
                i++;
            }
            
            return result;
        }

        // 王朝密码DOM元素
        const dynastyInputText = document.getElementById('dynastyInputText');
        const dynastyOutputText = document.getElementById('dynastyOutputText');
        const dynastyEncryptBtn = document.getElementById('dynastyEncryptBtn');
        const dynastyDecryptBtn = document.getElementById('dynastyDecryptBtn');
        const dynastyClearBtn = document.getElementById('dynastyClearBtn');
        const dynastyCopyInputBtn = document.getElementById('dynastyCopyInputBtn');
        const dynastyCopyOutputBtn = document.getElementById('dynastyCopyOutputBtn');

        // 王朝密码按钮事件
        dynastyEncryptBtn.addEventListener('click', () => {
            const text = dynastyInputText.value;
            dynastyOutputText.value = dynastyEncrypt(text);
            showFeedback('加密成功!');
        });

        dynastyDecryptBtn.addEventListener('click', () => {
            const text = dynastyInputText.value;
            dynastyOutputText.value = dynastyDecrypt(text);
            showFeedback('解密成功!');
        });

        dynastyClearBtn.addEventListener('click', () => {
            dynastyInputText.value = '';
            dynastyOutputText.value = '';
            dynastyInputText.focus();
            showFeedback('内容已清空');
        });

        // 王朝密码复制按钮事件
        dynastyCopyInputBtn.addEventListener('click', () => {
            if (dynastyInputText.value) {
                dynastyInputText.select();
                document.execCommand('copy');
                showFeedback('输入内容已复制');
            }
        });

        dynastyCopyOutputBtn.addEventListener('click', () => {
            if (dynastyOutputText.value) {
                dynastyOutputText.select();
                document.execCommand('copy');
                showFeedback('结果已复制');
            }
        });

        function showFeedback(message) {
            const feedback = document.createElement('div');
            feedback.textContent = message;
            feedback.style.position = 'fixed';
            feedback.style.bottom = '20px';
            feedback.style.right = '20px';
            feedback.style.background = 'rgba(0,0,0,0.7)';
            feedback.style.color = 'white';
            feedback.style.padding = '10px 20px';
            feedback.style.borderRadius = '5px';
            feedback.style.zIndex = '1000';
            feedback.style.transition = 'opacity 0.3s';
            feedback.style.opacity = '1';
            document.body.appendChild(feedback);
            
            setTimeout(() => {
                feedback.style.opacity = '0';
                setTimeout(() => {
                    document.body.removeChild(feedback);
                }, 300);
            }, 2000);
        }

        // 初始焦点在输入框
        inputText.focus();
    </script>
</body>
</html>
