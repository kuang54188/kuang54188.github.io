<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>增强密码工具集 | Meow & 王朝密码 & 摩斯密码</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        :root {
            --primary-color: #FF0080;
            --secondary-color: #FF8C00;
            --accent-color: #40E0D0;
            --text-color: #333;
            --bg-color: #ffffff;
            --card-bg: #ffffff;
            --border-color: rgba(255,255,255,0.2);
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            --button-bg: linear-gradient(90deg, #FF0080, #FF8C00);
            --button-hover: linear-gradient(90deg, #FF4D94, #FFB347);
            --success-color: #66FF99;
            --dynasty-primary: #1a2a6c;
            --dynasty-secondary: #b21f1f;
            --dynasty-tertiary: #fdbb2d;
            --meow-gradient: linear-gradient(90deg, #FF0080, #FF8C00, #FFD400);
            --dynasty-gradient: linear-gradient(90deg, #1a2a6c, #b21f1f, #fdbb2d);
            --morse-gradient: linear-gradient(90deg, #2b5876, #4e4376);
            --base64-gradient: linear-gradient(90deg, #4A00E0, #8E2DE2);
            --aes-gradient: linear-gradient(90deg, #11998e, #38ef7d);
            --sha-gradient: linear-gradient(90deg, #f46b45, #eea849);
        }

        .dark-mode {
            --text-color: #f0e6ff;
            --bg-color: #121212;
            --card-bg: rgba(30, 10, 30, 0.9);
            --border-color: rgba(255,255,255,0.1);
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
            --button-bg: linear-gradient(90deg, #FF4D94, #FF8C42);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s, max-height 0.5s ease, opacity 0.3s, transform 0.3s;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(125deg, 
                #FF0080, #FF512F, #FFD400, #40E0D0, #0093E9, #7A3DDA, #FF00FF);
            background-size: 300% 300%;
            animation: rainbow-gradient 12s ease infinite;
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        @keyframes rainbow-gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px 0;
        }

        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, 
                #FF0080, #FF8C00, #FFD400, #40E0D0, #0093E9, #7A3DDA, #FF00FF,
                #4A00E0, #8E2DE2, #11998e, #38ef7d, #f46b45, #eea849);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            animation: rainbow-text 12s ease infinite;
            background-size: 400% 400%;
        }

        @keyframes rainbow-text {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .description {
            color: white;
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 15px;
            border-radius: 20px;
            backdrop-filter: blur(5px);
        }

        .tabs-container {
            overflow-x: auto;
            margin-bottom: 20px;
            padding-bottom: 10px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.2);
            min-width: 800px;
            margin: 0 auto 15px;
        }

        .tab {
            flex: 1;
            text-align: center;
            padding: 15px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.3);
            font-weight: 600;
            transition: all 0.3s;
            font-size: 1.1rem;
            position: relative;
            overflow: hidden;
            z-index: 1;
            min-width: 120px;
        }

        .tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .tab[data-tab="meow"]::before {
            background: var(--meow-gradient);
        }
        
        .tab[data-tab="dynasty"]::before {
            background: var(--dynasty-gradient);
        }
        
        .tab[data-tab="morse"]::before {
            background: var(--morse-gradient);
        }
        
        .tab[data-tab="base64"]::before {
            background: var(--base64-gradient);
        }
        
        .tab[data-tab="aes"]::before {
            background: var(--aes-gradient);
        }
        
        .tab[data-tab="sha"]::before {
            background: var(--sha-gradient);
        }

        .tab.active::before {
            opacity: 1;
        }

        .tab.active {
            color: white;
        }

        .card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }

        .collapsible-card {
            overflow: hidden;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            padding-bottom: 15px;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .card-header h2 {
            display: flex;
            align-items: center;
            font-size: 1.4rem;
        }
        
        .card-header h2 i {
            margin-right: 10px;
            transition: transform 0.3s;
        }
        
        .card-header .toggle-icon {
            font-size: 1.2rem;
            transition: transform 0.3s;
        }
        
        .card-content {
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: max-height 0.5s ease, opacity 0.5s ease;
        }
        
        .card.expanded .card-content {
            max-height: 2000px;
            opacity: 1;
        }
        
        .card.expanded .card-header .toggle-icon {
            transform: rotate(180deg);
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
            font-size: 1.1rem;
        }

        textarea, input {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            background: var(--card-bg);
            color: var(--text-color);
            font-size: 1rem;
            transition: all 0.3s;
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        input {
            margin-bottom: 15px;
        }

        textarea:focus, input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(64, 224, 208, 0.4);
        }

        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        button {
            padding: 14px 20px;
            border: none;
            border-radius: 10px;
            background: var(--button-bg);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--button-hover);
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s;
        }

        button:hover::before {
            opacity: 1;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }

        button i {
            margin-right: 8px;
        }

        .success {
            background: var(--success-color);
            color: #000;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            z-index: 100;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        /* 新增下载按钮样式 */
        .download-toggle {
            position: fixed;
            top: 20px;
            left: 20px; /* 左上角位置 */
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            z-index: 100;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        .theme-toggle:hover, .download-toggle:hover {
            transform: scale(1.1);
        }

        .theme-toggle i, .download-toggle i {
            font-size: 1.5rem;
            color: white;
        }

        .result-container {
            margin-bottom: 15px;
        }

        .result-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 10px;
        }

        .copy-btn {
            padding: 12px 25px;
            background: var(--button-bg);
            color: white;
            font-weight: 600;
            border-radius: 8px;
            display: flex;
            align-items: center;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .copy-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--button-hover);
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .copy-btn:hover::before {
            opacity: 1;
        }

        .copy-btn:hover {
            transform: translateY(-2px);
        }

        .char-set {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
            padding: 15px;
            background: rgba(255,255,255,0.15);
            border-radius: 12px;
        }

        .char-set span {
            font-family: monospace;
            font-size: 1.1rem;
            padding: 5px 12px;
            background: rgba(255,255,255,0.2);
            border-radius: 6px;
            transition: all 0.3s;
        }

        .char-set span:hover {
            transform: translateY(-3px);
            background: rgba(255,255,255,0.3);
        }

        .dynasty-char-set {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 15px;
            padding: 15px;
            background: rgba(255,255,255,0.15);
            border-radius: 12px;
        }
        
        .dynasty-char-set span {
            font-family: monospace;
            font-size: 1.1rem;
            padding: 8px 10px;
            background: rgba(255,255,255,0.2);
            border-radius: 6px;
            text-align: center;
            transition: all 0.3s;
        }

        .dynasty-char-set span:hover {
            background: linear-gradient(90deg, rgba(26,42,108,0.3), rgba(178,31,31,0.3), rgba(253,187,45,0.3));
            transform: translateY(-3px);
        }
        
        .dynasty-char-set .zone-label {
            grid-column: 1 / -1;
            font-weight: bold;
            background: rgba(255,255,255,0.3);
            margin-top: 10px;
            margin-bottom: 5px;
            padding: 8px;
            border-radius: 6px;
            background: linear-gradient(90deg, rgba(26,42,108,0.3), rgba(178,31,31,0.3), rgba(253,187,45,0.3));
        }
        
        .morse-char-set {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 12px;
            margin-top: 20px;
            padding: 15px;
            background: rgba(255,255,255,0.15);
            border-radius: 12px;
        }
        
        .morse-char-set div {
            font-family: monospace;
            font-size: 1.1rem;
            padding: 10px;
            background: rgba(255,255,255,0.2);
            border-radius: 8px;
            text-align: center;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .morse-char-set div:hover {
            background: linear-gradient(90deg, rgba(43,88,118,0.3), rgba(78,67,118,0.3));
            transform: translateY(-3px);
        }
        
        .morse-char-set .char {
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 5px;
        }
        
        .morse-char-set .code {
            font-size: 0.95rem;
            color: #666;
        }
        
        .dark-mode .morse-char-set .code {
            color: #aaa;
        }
        
        .cipher-info {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .cipher-info-card {
            flex: 1;
            min-width: 300px;
            background: rgba(255,255,255,0.15);
            border-radius: 12px;
            padding: 20px;
        }
        
        .cipher-info-card h3 {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255,255,255,0.2);
        }
        
        .cipher-info-card h3 i {
            margin-right: 10px;
        }
        
        .cipher-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .action-btn {
            flex: 1;
            padding: 14px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            position: relative;
            overflow: hidden;
            z-index: 1;
            border: none;
            color: white;
        }
        
        .action-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .action-btn:hover::before {
            opacity: 1;
        }
        
        .action-btn.encrypt {
            background: linear-gradient(90deg, #2193b0, #6dd5ed);
        }
        
        .action-btn.encrypt::before {
            background: linear-gradient(90deg, #1a2a6c, #2193b0);
        }
        
        .action-btn.decrypt {
            background: linear-gradient(90deg, #ff416c, #ff4b2b);
        }
        
        .action-btn.decrypt::before {
            background: linear-gradient(90deg, #b21f1f, #ff416c);
        }
        
        .action-btn.clear {
            background: linear-gradient(90deg, #8e9eab, #eef2f3);
            color: #333;
        }
        
        .action-btn.clear::before {
            background: linear-gradient(90deg, #fdbb2d, #eef2f3);
        }
        
        .action-btn.copy {
            background: linear-gradient(90deg, #5d8aa8, #7db9e8);
        }
        
        .action-btn.copy::before {
            background: linear-gradient(90deg, #1a2a6c, #5d8aa8);
        }
        
        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }
        
        .mode-toggle {
            display: flex;
            background: rgba(255,255,255,0.2);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        .mode-btn {
            flex: 1;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            position: relative;
        }
        
        .mode-btn.active {
            background: rgba(255,255,255,0.3);
            color: white;
        }
        
        .mode-btn.encrypt.active {
            background: linear-gradient(90deg, #2193b0, #6dd5ed);
        }
        
        .mode-btn.decrypt.active {
            background: linear-gradient(90deg, #ff416c, #ff4b2b);
        }
        
        .charset-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 30px;
        }
        
        .charset-panel {
            flex: 1;
            min-width: 300px;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 20px;
            overflow: hidden;
        }
        
        .charset-panel h3 {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        
        .charset-panel h3 i {
            margin-right: 10px;
        }
        
        .charset-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-out;
        }
        
        .charset-panel.active .charset-content {
            max-height: 1000px;
            transition: max-height 0.5s ease-in;
        }
        
        .charset-toggle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }
        
        .charset-toggle i {
            transition: transform 0.3s;
        }
        
        .charset-panel.active .charset-toggle i {
            transform: rotate(180deg);
        }
        
        .key-input-group {
            margin-bottom: 20px;
        }
        
        .key-input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
            font-size: 1.1rem;
        }
        
        .key-input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--card-bg);
            color: var(--text-color);
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .key-input-group input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(64, 224, 208, 0.4);
        }
        
        .cipher-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .cipher-stats {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }
        
        .stat-card {
            flex: 1;
            min-width: 120px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .stat-card .value {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-card .label {
            font-size: 0.9rem;
            color: rgba(255,255,255,0.8);
        }
        
        .hash-info {
            margin-top: 15px;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            font-family: monospace;
            overflow-x: auto;
        }
        
        .expand-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            transition: all 0.3s;
        }
        
        .card.expanded .expand-indicator {
            background: rgba(255,255,255,0.4);
        }
        
        .collapsed-summary {
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            margin-top: 10px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
        }
        
        .collapsed-summary i {
            margin-right: 8px;
            color: var(--accent-color);
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .tabs {
                flex-direction: column;
                min-width: 100%;
            }
            
            .button-group, .result-buttons, .cipher-actions {
                flex-direction: column;
            }
            
            button, .copy-btn, .action-btn {
                width: 100%;
            }
            
            .morse-char-set {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
            
            .cipher-info {
                flex-direction: column;
            }
            
            .charset-panel {
                min-width: 100%;
            }
            
            .cipher-info-grid {
                grid-template-columns: 1fr;
            }
            
            /* 移动端调整按钮位置 */
            .theme-toggle {
                top: 80px; /* 降低位置避免重叠 */
            }
        }
    </style>
</head>
<body>
    <!-- 新增的下载按钮 -->
    <a href="https://www.123865.com/s/jE4Fjv-V9Geh" class="download-toggle" id="downloadBtn" target="_blank">
        <i class="fas fa-download"></i>
    </a>
    
    <div class="theme-toggle" id="themeToggle">
        <i class="fas fa-moon"></i>
    </div>

    <div class="container">
        <header>
            <h1>增强密码工具集</h1>
            <p class="description">
                <i class="fas fa-shield-alt honey-icon"></i> 
                Meow & 王朝 & 摩斯 & Base64 & AES & SHA-256 一站式加密解决方案
            </p>
        </header>

        <div class="tabs-container">
            <div class="tabs">
                <div class="tab active" data-tab="meow">Meow密码</div>
                <div class="tab" data-tab="dynasty">王朝密码</div>
                <div class="tab" data-tab="morse">摩斯密码</div>
                <div class="tab" data-tab="base64">Base64</div>
                <div class="tab" data-tab="aes">AES</div>
                <div class="tab" data-tab="sha">SHA-256</div>
            </div>
        </div>

        <!-- 统一输入输出区域 -->
        <div class="card collapsible-card">
            <div class="card-header" onclick="toggleCard(this)">
                <h2><i class="fas fa-keyboard"></i> 加密/解密操作</h2>
                <div class="expand-indicator">
                    <i class="fas fa-chevron-down toggle-icon"></i>
                </div>
            </div>
            <div class="card-content">
                <div class="input-group">
                    <label for="inputText"><i class="fas fa-pen"></i> 输入内容</label>
                    <textarea id="inputText" placeholder="输入要加密/解密的内容..."></textarea>
                </div>
                
                <!-- 密钥输入区域（AES需要） -->
                <div class="key-input-group" id="keyInputGroup" style="display: none;">
                    <label for="keyInput"><i class="fas fa-key"></i> 密钥</label>
                    <input type="text" id="keyInput" placeholder="输入AES加密密钥...">
                </div>
                
                <div class="mode-toggle">
                    <div class="mode-btn encrypt active">加密模式</div>
                    <div class="mode-btn decrypt">解密模式</div>
                </div>

                <div class="cipher-actions">
                    <button class="action-btn encrypt" id="processBtn">
                        <i class="fas fa-lock"></i> 执行操作
                    </button>
                    <button class="action-btn clear" id="clearBtn">
                        <i class="fas fa-trash-alt"></i> 清空
                    </button>
                </div>
            </div>
        </div>

        <div class="card collapsible-card">
            <div class="card-header" onclick="toggleCard(this)">
                <h2><i class="fas fa-lock"></i> 结果输出</h2>
                <div class="expand-indicator">
                    <i class="fas fa-chevron-down toggle-icon"></i>
                </div>
            </div>
            <div class="card-content">
                <div class="input-group">
                    <label for="resultText"><i class="fas fa-key"></i> 结果</label>
                    <div class="result-container">
                        <textarea id="resultText" readonly placeholder="加密/解密结果将在这里显示..."></textarea>
                    </div>
                </div>
                <div class="result-buttons">
                    <button class="action-btn copy" id="copyBtn">
                        <i class="fas fa-copy"></i> 复制结果
                    </button>
                </div>
            </div>
        </div>
        
        <!-- 密码信息区域 -->
        <div class="card collapsible-card">
            <div class="card-header" onclick="toggleCard(this)">
                <h2><i class="fas fa-info-circle"></i> 密码信息</h2>
                <div class="expand-indicator">
                    <i class="fas fa-chevron-down toggle-icon"></i>
                </div>
            </div>
            <div class="card-content">
                <div class="cipher-info">
                    <div class="cipher-info-card">
                        <h3><i class="fas fa-info-circle"></i> 当前密码信息</h3>
                        <div id="cipherDescription">
                            <p>Meow密码是一种基于ASCII偏移的轻量级加密算法，使用"meow"序列作为密钥。</p>
                            <p>支持字母、数字、符号和中文内容加密。</p>
                        </div>
                        <div class="cipher-stats">
                            <div class="stat-card">
                                <div class="value" id="inputLength">0</div>
                                <div class="label">输入长度</div>
                            </div>
                            <div class="stat-card">
                                <div class="value" id="outputLength">0</div>
                                <div class="label">输出长度</div>
                            </div>
                            <div class="stat-card">
                                <div class="value" id="processTime">0ms</div>
                                <div class="label">处理时间</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="cipher-info-card">
                        <h3><i class="fas fa-bolt"></i> 操作说明</h3>
                        <ul>
                            <li>选择上方选项卡切换密码类型</li>
                            <li>选择加密/解密模式</li>
                            <li>输入内容并点击"执行操作"</li>
                            <li>结果将显示在下方区域</li>
                            <li>AES加密需要提供密钥</li>
                            <li>使用"复制结果"按钮分享</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 字符集说明区域 -->
        <div class="card collapsible-card">
            <div class="card-header" onclick="toggleCard(this)">
                <h2><i class="fas fa-book"></i> 字符集参考</h2>
                <div class="expand-indicator">
                    <i class="fas fa-chevron-down toggle-icon"></i>
                </div>
            </div>
            <div class="card-content">
                <div class="charset-container">
                    <div class="charset-panel" id="meow-charset">
                        <div class="charset-toggle">
                            <h3><i class="fas fa-honey-pot"></i> Meow密码字符集</h3>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="charset-content">
                            <div class="char-set">
                                <span>A-Z</span>
                                <span>a-z</span>
                                <span>0-9</span>
                                <span>! @ # $ %</span>
                                <span>^ & * ( )</span>
                                <span>- _ + =</span>
                                <span>{ } [ ]</span>
                                <span>: ; " '</span>
                                <span>, . ? /</span>
                                <span>\ | ~ `</span>
                                <span>中文</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="charset-panel" id="dynasty-charset">
                        <div class="charset-toggle">
                            <h3><i class="fas fa-key"></i> 王朝密码字符集</h3>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="charset-content">
                            <div class="dynasty-char-set">
                                <div class="zone-label">X 区</div>
                                <span>a → X1</span>
                                <span>b → X2</span>
                                <span>c → X3</span>
                                <span>d → X4</span>
                                <span>e → X5</span>
                                <span>f → X6</span>
                                <span>g → X7</span>
                                <span>h → X8</span>
                                <span>i → X9</span>
                                
                                <div class="zone-label">Y 区</div>
                                <span>j → Y1</span>
                                <span>k → Y2</span>
                                <span>l → Y3</span>
                                <span>m → Y4</span>
                                <span>n → Y5</span>
                                <span>o → Y6</span>
                                <span>p → Y7</span>
                                <span>q → Y8</span>
                                <span>r → Y9</span>
                                
                                <div class="zone-label">Z 区</div>
                                <span>s → Z1</span>
                                <span>t → Z2</span>
                                <span>u → Z3</span>
                                <span>v → Z4</span>
                                <span>w → Z5</span>
                                <span>x → Z6</span>
                                <span>y → Z7</span>
                                <span>z → Z8</span>
                                
                                <div class="zone-label">特殊功能</div>
                                <span>空格 → L5</span>
                                <span>大写 → L6</span>
                                <span>ā → L1</span>
                                <span>á → L2</span>
                                <span>ǎ → L3</span>
                                <span>à → L4</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="charset-panel" id="morse-charset">
                        <div class="charset-toggle">
                            <h3><i class="fas fa-wifi"></i> 摩斯密码字符集</h3>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="charset-content">
                            <div class="morse-char-set">
                                <div><span class="char">A</span><span class="code">.-</span></div>
                                <div><span class="char">B</span><span class="code">-...</span></div>
                                <div><span class="char">C</span><span class="code">-.-.</span></div>
                                <div><span class="char">D</span><span class="code">-..</span></div>
                                <div><span class="char">E</span><span class="code">.</span></div>
                                <div><span class="char">F</span><span class="code">..-.</span></div>
                                <div><span class="char">G</span><span class="code">--.</span></div>
                                <div><span class="char">H</span><span class="code">....</span></div>
                                <div><span class="char">I</span><span class="code">..</span></div>
                                <div><span class="char">J</span><span class="code">.---</span></div>
                                <div><span class="char">K</span><span class="code">-.-</span></div>
                                <div><span class="char">L</span><span class="code">.-..</span></div>
                                <div><span class="char">M</span><span class="code">--</span></div>
                                <div><span class="char">N</span><span class="code">-.</span></div>
                                <div><span class="char">O</span><span class="code">---</span></div>
                                <div><span class="char">P</span><span class="code">.--.</span></div>
                                <div><span class="char">Q</span><span class="code">--.-</span></div>
                                <div><span class="char">R</span><span class="code">.-.</span></div>
                                <div><span class="char">S</span><span class="code">...</span></div>
                                <div><span class="char">T</span><span class="code">-</span></div>
                                <div><span class="char">U</span><span class="code">..-</span></div>
                                <div><span class="char">V</span><span class="code">...-</span></div>
                                <div><span class="char">W</span><span class="code">.--</span></div>
                                <div><span class="char">X</span><span class="code">-..-</span></div>
                                <div><span class="char">Y</span><span class="code">-.--</span></div>
                                <div><span class="char">Z</span><span class="code">--..</span></div>
                                <div><span class="char">0</span><span class="code">-----</span></div>
                                <div><span class="char">1</span><span class="code">.----</span></div>
                                <div><span class="char">2</span><span class="code">..---</span></div>
                                <div><span class="char">3</span><span class="code">...--</span></div>
                                <div><span class="char">4</span><span class="code">....-</span></div>
                                <div><span class="char">5</span><span class="code">.....</span></div>
                                <div><span class="char">6</span><span class="code">-....</span></div>
                                <div><span class="char">7</span><span class="code">--...</span></div>
                                <div><span class="char">8</span><span class="code">---..</span></div>
                                <div><span class="char">9</span><span class="code">----.</span></div>
                                <div><span class="char">.</span><span class="code">.-.-.-</span></div>
                                <div><span class="char">,</span><span class="code">--..--</span></div>
                                <div><span class="char">?</span><span class="code">..--..</span></div>
                                <div><span class="char">'</span><span class="code">.----.</span></div>
                                <div><span class="char">!</span><span class="code">-.-.--</span></div>
                                <div><span class="char">/</span><span class="code">-..-.</span></div>
                                <div><span class="char">(</span><span class="code">-.--.</span></div>
                                <div><span class="char">)</span><span class="code">-.--.-</span></div>
                                <div><span class="char">&</span><span class="code">.-...</span></div>
                                <div><span class="char">:</span><span class="code">---...</span></div>
                                <div><span class="char">;</span><span class="code">-.-.-.</span></div>
                                <div><span class="char">=</span><span class="code">-...-</span></div>
                                <div><span class="char">+</span><span class="code">.-.-.</span></div>
                                <div><span class="char">-</span><span class="code">-....-</span></div>
                                <div><span class="char">"</span><span class="code">.-..-.</span></div>
                                <div><span class="char">@</span><span class="code">.--.-.</span></div>
                                <div><span class="char">空格</span><span class="code">/</span></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 新增的加密算法信息 -->
        <div class="card collapsible-card">
            <div class="card-header" onclick="toggleCard(this)">
                <h2><i class="fas fa-lock"></i> 加密算法信息</h2>
                <div class="expand-indicator">
                    <i class="fas fa-chevron-down toggle-icon"></i>
                </div>
            </div>
            <div class="card-content">
                <div class="cipher-info-grid">
                    <div class="card">
                        <h3><i class="fas fa-lock"></i> Base64 加密</h3>
                        <p>Base64是一种基于64个可打印字符来表示二进制数据的编码方法。</p>
                        <div class="hash-info">
                            <p><strong>特点：</strong></p>
                            <ul>
                                <li>将二进制数据转换为可打印的ASCII字符</li>
                                <li>常用于在HTTP环境下传输二进制数据</li>
                                <li>编码后数据比原始数据大约33%</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3><i class="fas fa-shield-alt"></i> AES 加密</h3>
                        <p>AES（高级加密标准）是一种对称加密算法，被广泛用于保护敏感数据。</p>
                        <div class="hash-info">
                            <p><strong>特点：</strong></p>
                            <ul>
                                <li>支持128、192和256位密钥长度</li>
                                <li>被美国政府选为保护最高机密信息的标准</li>
                                <li>快速且在各种硬件上高效实现</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3><i class="fas fa-fingerprint"></i> SHA-256 哈希</h3>
                        <p>SHA-256是SHA-2系列中的一种加密哈希函数，生成256位（32字节）哈希值。</p>
                        <div class="hash-info">
                            <p><strong>特点：</strong></p>
                            <ul>
                                <li>用于区块链技术（如比特币）</li>
                                <li>抗碰撞性 - 很难找到两个不同的输入产生相同哈希值</li>
                                <li>单向函数 - 无法从哈希值反推原始数据</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>增强密码工具集 <i class="fas fa-shield-alt honey-icon"></i> 专业安全加密工具 <i class="fas fa-lock honey-icon"></i> © 2023</p>
        </footer>
    </div>

    <script>
        // 切换主题
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = themeToggle.querySelector('i');
        
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            if (document.body.classList.contains('dark-mode')) {
                themeIcon.className = 'fas fa-sun';
            } else {
                themeIcon.className = 'fas fa-moon';
            }
        });

        // 卡片折叠/展开功能
        function toggleCard(element) {
            const card = element.closest('.card');
            card.classList.toggle('expanded');
        }
        
        // 默认折叠所有卡片
        document.querySelectorAll('.collapsible-card').forEach(card => {
            card.classList.remove('expanded');
        });

        // 选项卡切换
        const tabs = document.querySelectorAll('.tab');
        let currentCipher = 'meow';
        const keyInputGroup = document.getElementById('keyInputGroup');
        
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // 移除所有活动状态
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                currentCipher = tab.dataset.tab;
                
                // 更新描述
                updateCipherDescription();
                
                // 更新字符集面板
                updateCharsetPanels();
                
                // 显示/隐藏密钥输入
                if (currentCipher === 'aes') {
                    keyInputGroup.style.display = 'block';
                } else {
                    keyInputGroup.style.display = 'none';
                }
            });
        });
        
        // 更新密码描述
        function updateCipherDescription() {
            const descElement = document.getElementById('cipherDescription');
            switch(currentCipher) {
                case 'meow':
                    descElement.innerHTML = `
                        <p>Meow密码是一种基于ASCII偏移的轻量级加密算法，使用"meow"序列作为密钥。</p>
                        <p>支持字母、数字、符号和中文内容加密。</p>
                    `;
                    break;
                case 'dynasty':
                    descElement.innerHTML = `
                        <p>王朝密码是一种基于分区映射的加密系统，将字母映射到不同的王朝区域。</p>
                        <p>支持字母、数字、基本符号和特殊控制功能。</p>
                    `;
                    break;
                case 'morse':
                    descElement.innerHTML = `
                        <p>摩斯密码是一种国际通用的信号编码系统，使用点和划的组合表示字符。</p>
                        <p>支持字母、数字和常用符号，空格用斜杠(/)表示。</p>
                    `;
                    break;
                case 'base64':
                    descElement.innerHTML = `
                        <p>Base64是一种基于64个可打印字符来表示二进制数据的编码方法。</p>
                        <p>常用于在文本环境中传输二进制数据，如电子邮件附件。</p>
                    `;
                    break;
                case 'aes':
                    descElement.innerHTML = `
                        <p>AES（高级加密标准）是一种对称加密算法，被广泛用于保护敏感数据。</p>
                        <p>需要提供密钥进行加密和解密操作，支持128、192和256位密钥长度。</p>
                    `;
                    break;
                case 'sha':
                    descElement.innerHTML = `
                        <p>SHA-256是SHA-2系列中的一种加密哈希函数，生成256位（32字节）哈希值。</p>
                        <p>常用于数据完整性验证和数字签名，是一种单向加密函数。</p>
                    `;
                    break;
            }
        }
        
        // 更新字符集面板
        function updateCharsetPanels() {
            document.querySelectorAll('.charset-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            document.getElementById(`${currentCipher}-charset`).classList.add('active');
        }
        
        // 字符集面板切换
        document.querySelectorAll('.charset-toggle').forEach(toggle => {
            toggle.addEventListener('click', () => {
                const panel = toggle.closest('.charset-panel');
                panel.classList.toggle('active');
            });
        });
        
        // 模式切换
        const modeBtns = document.querySelectorAll('.mode-btn');
        let currentMode = 'encrypt';
        
        modeBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                modeBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentMode = btn.classList.contains('encrypt') ? 'encrypt' : 'decrypt';
                
                // 更新处理按钮文本
                const processBtn = document.getElementById('processBtn');
                processBtn.innerHTML = currentMode === 'encrypt' 
                    ? '<i class="fas fa-lock"></i> 加密' 
                    : '<i class="fas fa-lock-open"></i> 解密';
                
                // 对于SHA-256，解密模式不可用
                if (currentCipher === 'sha' && currentMode === 'decrypt') {
                    showFeedback('SHA-256是单向哈希函数，不支持解密操作');
                }
            });
        });

        // ================= 加密解密函数 =================
        // Meow密码
        function encrypt(text) {
            if (!text) return '';
            
            const meowSequence = ['m', 'e', 'o', 'w'];
            let result = '';
            let meowIndex = 0;
            
            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                const meowChar = meowSequence[meowIndex];
                
                // 获取字符的ASCII码
                const charCode = char.charCodeAt(0);
                
                // 应用meow字符的偏移量
                const offset = meowChar.charCodeAt(0) - 97; // a=97 in ASCII
                let newCharCode = charCode + offset;
                
                // 处理超出可打印字符范围的情况
                if (charCode >= 32 && charCode <= 126) {
                    // 可打印字符范围
                    while (newCharCode > 126) {
                        newCharCode = 32 + (newCharCode - 127);
                    }
                }
                
                result += String.fromCharCode(newCharCode);
                
                // 更新meow索引
                meowIndex = (meowIndex + 1) % meowSequence.length;
            }
            
            return result;
        }

        function decrypt(text) {
            if (!text) return '';
            
            const meowSequence = ['m', 'e', 'o', 'w'];
            let result = '';
            let meowIndex = 0;
            
            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                const meowChar = meowSequence[meowIndex];
                
                // 获取字符的ASCII码
                const charCode = char.charCodeAt(0);
                
                // 应用meow字符的偏移量（反向）
                const offset = meowChar.charCodeAt(0) - 97; // a=97 in ASCII
                let newCharCode = charCode - offset;
                
                // 处理超出可打印字符范围的情况
                if (charCode >= 32 && charCode <= 126) {
                    // 可打印字符范围
                    while (newCharCode < 32) {
                        newCharCode = 127 - (32 - newCharCode);
                    }
                }
                
                result += String.fromCharCode(newCharCode);
                
                // 更新meow索引
                meowIndex = (meowIndex + 1) % meowSequence.length;
            }
            
            return result;
        }

        // 王朝密码
        const charToZone = {
            'a': ['X', '1'], 'b': ['X', '2'], 'c': ['X', '3'], 'd': ['X', '4'], 'e': ['X', '5'],
            'f': ['X', '6'], 'g': ['X', '7'], 'h': ['X', '8'], 'i': ['X', '9'],
            'j': ['Y', '1'], 'k': ['Y', '2'], 'l': ['Y', '3'], 'm': ['Y', '4'], 'n': ['Y', '5'],
            'o': ['Y', '6'], 'p': ['Y', '7'], 'q': ['Y', '8'], 'r': ['Y', '9'],
            's': ['Z', '1'], 't': ['Z', '2'], 'u': ['Z', '3'], 'v': ['Z', '4'], 'ü': ['Z', '4'],
            'w': ['Z', '5'], 'x': ['Z', '6'], 'y': ['Z', '7'], 'z': ['Z', '8'],
            '0': ['M', '0'], '1': ['M', '9'], '2': ['M', '8'], '3': ['M', '7'], '4': ['M', '6'],
            '5': ['M', '5'], '6': ['M', '4'], '7': ['M', '3'], '8': ['M', '2'], '9': ['M', '1'],
            '，': ['N', '1'], '。': ['N', '2'], '？': ['N', '3'], '！': ['N', '4'],
            '@': ['N', '5'], '．': ['N', '6'], '"': ['N', '7'],
            ' ': ['L', '5']
        };

        const toneMap = {
            'ā': 'L1', 'á': 'L2', 'ǎ': 'L3', 'à': 'L4'
        };

        function dynastyEncrypt(text) {
            if (!text) return '';
            
            let result = '';
            let currentZone = null;
            let inUpperCase = false;
            let uppercaseSequence = false;
            
            for (let i = 0; i < text.length; i++) {
                let char = text[i];
                
                // 处理大写字母
                if (/[A-Z]/.test(char)) {
                    if (!inUpperCase) {
                        result += 'L6';
                        inUpperCase = true;
                        uppercaseSequence = true;
                    }
                    char = char.toLowerCase();
                } else if (inUpperCase && /[^a-zA-Z]/.test(char)) {
                    result += 'L6';
                    inUpperCase = false;
                }
                
                // 处理带声调字符
                if (toneMap[char]) {
                    result += toneMap[char];
                    currentZone = null;
                    continue;
                }
                
                // 查找字符映射
                const mapping = charToZone[char] || 
                               charToZone[char.toLowerCase()] || 
                               [null, null];
                
                const [zone, seq] = mapping;
                
                if (zone && seq) {
                    // 同区优化
                    if (zone === currentZone && !uppercaseSequence) {
                        result += seq;
                    } else {
                        result += zone + seq;
                        currentZone = zone;
                    }
                    
                    // 结束大写序列
                    if (uppercaseSequence) {
                        uppercaseSequence = false;
                    }
                } else {
                    // 不在映射表中的字符直接保留
                    result += char;
                    currentZone = null;
                }
            }
            
            // 结束大写序列
            if (inUpperCase) {
                result += 'L6';
            }
            
            return result;
        }

        function dynastyDecrypt(text) {
            if (!text) return '';
            
            let result = '';
            let i = 0;
            let currentZone = null;
            let inUpperCase = false;
            
            // 区号到字符的映射
            const zoneToChar = {
                'X': { 
                    '1': 'a', '2': 'b', '3': 'c', '4': 'd', '5': 'e',
                    '6': 'f', '7': 'g', '8': 'h', '9': 'i'
                },
                'Y': {
                    '1': 'j', '2': 'k', '3': 'l', '4': 'm', '5': 'n',
                    '6': 'o', '7': 'p', '8': 'q', '9': 'r'
                },
                'Z': {
                    '1': 's', '2': 't', '3': 'u', '4': 'v', '5': 'w',
                    '6': 'x', '7': 'y', '8': 'z'
                },
                'M': {
                    '0': '0', '1': '9', '2': '8', '3': '7', '4': '6',
                    '5': '5', '6': '4', '7': '3', '8': '2', '9': '1'
                },
                'N': {
                    '1': '，', '2': '。', '3': '？', '4': '！',
                    '5': '@', '6': '．', '7': '"'
                },
                'L': {
                    '1': 'ā', '2': 'á', '3': 'ǎ', '4': 'à', '5': ' '
                }
            };
            
            while (i < text.length) {
                const char = text[i];
                
                // 处理L区控制符
                if (char === 'L') {
                    const nextChar = text[i + 1];
                    i += 2;
                    
                    if (nextChar === '6') {
                        inUpperCase = !inUpperCase;
                    } else if (nextChar === '5') {
                        result += ' ';
                    } else if (nextChar) {
                        const toneChar = zoneToChar['L'][nextChar];
                        if (toneChar) result += toneChar;
                    }
                    continue;
                }
                
                // 处理区号
                if (['X', 'Y', 'Z', 'M', 'N'].includes(char)) {
                    currentZone = char;
                    i++;
                    
                    // 处理区号后的数字序列
                    while (i < text.length && /\d/.test(text[i])) {
                        const seq = text[i];
                        i++;
                        
                        const charMap = zoneToChar[currentZone];
                        if (charMap && charMap[seq]) {
                            let decryptedChar = charMap[seq];
                            if (inUpperCase && /[a-z]/.test(decryptedChar)) {
                                decryptedChar = decryptedChar.toUpperCase();
                            }
                            result += decryptedChar;
                        }
                    }
                    continue;
                }
                
                // 处理普通字符
                result += char;
                i++;
            }
            
            return result;
        }

        // 摩斯密码
        const morseCodeMap = {
            'A': '.-', 'B': '-...', 'C': '-.-.', 'D': '-..', 'E': '.', 'F': '..-.',
            'G': '--.', 'H': '....', 'I': '..', 'J': '.---', 'K': '-.-', 'L': '.-..',
            'M': '--', 'N': '-.', 'O': '---', 'P': '.--.', 'Q': '--.-', 'R': '.-.',
            'S': '...', 'T': '-', 'U': '..-', 'V': '...-', 'W': '.--', 'X': '-..-',
            'Y': '-.--', 'Z': '--..',
            '0': '-----', '1': '.----', '2': '..---', '3': '...--', '4': '....-',
            '5': '.....', '6': '-....', '7': '--...', '8': '---..', '9': '----.',
            '.': '.-.-.-', ',': '--..--', '?': '..--..', "'": '.----.', '!': '-.-.--',
            '/': '-..-.', '(': '-.--.', ')': '-.--.-', '&': '.-...', ':': '---...',
            ';': '-.-.-.', '=': '-...-', '+': '.-.-.', '-': '-....-', '"': '.-..-.',
            '@': '.--.-.', ' ': '/'
        };
        
        // 反转映射用于解密
        const morseReverseMap = {};
        for (const char in morseCodeMap) {
            morseReverseMap[morseCodeMap[char]] = char;
        }
        
        function morseEncrypt(text) {
            if (!text) return '';
            
            const upperText = text.toUpperCase();
            let result = '';
            
            for (let i = 0; i < upperText.length; i++) {
                const char = upperText[i];
                
                if (char in morseCodeMap) {
                    result += morseCodeMap[char] + ' ';
                } else {
                    result += char + ' ';
                }
            }
            
            return result.trim();
        }
        
        function morseDecrypt(text) {
            if (!text) return '';
            
            // 分割摩斯码，支持空格和斜杠作为分隔符
            const morseWords = text.trim().split('/');
            let result = '';
            
            for (let i = 0; i < morseWords.length; i++) {
                const word = morseWords[i].trim();
                if (!word) continue;
                
                const morseChars = word.split(' ');
                
                for (let j = 0; j < morseChars.length; j++) {
                    const code = morseChars[j].trim();
                    if (!code) continue;
                    
                    if (code in morseReverseMap) {
                        result += morseReverseMap[code];
                    } else {
                        result += code;
                    }
                }
                
                if (i < morseWords.length - 1) {
                    result += ' ';
                }
            }
            
            return result;
        }
        
        // ================= 新增加密算法 =================
        // Base64编码/解码
        function base64Encrypt(text) {
            return btoa(unescape(encodeURIComponent(text)));
        }
        
        function base64Decrypt(text) {
            try {
                return decodeURIComponent(escape(atob(text)));
            } catch (e) {
                return "Base64解码错误: 输入格式无效";
            }
        }
        
        // AES加密/解密
        function aesEncrypt(text, key) {
            if (!key) return "错误: 需要提供密钥";
            
            try {
                const encrypted = CryptoJS.AES.encrypt(text, key);
                return encrypted.toString();
            } catch (e) {
                return "AES加密错误: " + e.message;
            }
        }
        
        function aesDecrypt(text, key) {
            if (!key) return "错误: 需要提供密钥";
            
            try {
                const decrypted = CryptoJS.AES.decrypt(text, key);
                return decrypted.toString(CryptoJS.enc.Utf8) || "解密失败: 密钥可能不正确";
            } catch (e) {
                return "AES解密错误: " + e.message;
            }
        }
        
        // SHA-256哈希
        function sha256Hash(text) {
            return CryptoJS.SHA256(text).toString(CryptoJS.enc.Hex);
        }

        // ================= DOM操作 =================
        const inputText = document.getElementById('inputText');
        const resultText = document.getElementById('resultText');
        const keyInput = document.getElementById('keyInput');
        const processBtn = document.getElementById('processBtn');
        const clearBtn = document.getElementById('clearBtn');
        const copyBtn = document.getElementById('copyBtn');
        const inputLength = document.getElementById('inputLength');
        const outputLength = document.getElementById('outputLength');
        const processTime = document.getElementById('processTime');

        // 输入长度统计
        inputText.addEventListener('input', () => {
            inputLength.textContent = inputText.value.length;
        });

        // 处理按钮事件
        processBtn.addEventListener('click', () => {
            const startTime = performance.now();
            const text = inputText.value;
            const key = keyInput.value;
            let result = '';
            
            // SHA-256不支持解密
            if (currentCipher === 'sha' && currentMode === 'decrypt') {
                showFeedback('SHA-256是单向哈希函数，不支持解密操作');
                return;
            }
            
            if (currentMode === 'encrypt') {
                switch(currentCipher) {
                    case 'meow':
                        result = encrypt(text);
                        break;
                    case 'dynasty':
                        result = dynastyEncrypt(text);
                        break;
                    case 'morse':
                        result = morseEncrypt(text);
                        break;
                    case 'base64':
                        result = base64Encrypt(text);
                        break;
                    case 'aes':
                        result = aesEncrypt(text, key);
                        break;
                    case 'sha':
                        result = sha256Hash(text);
                        break;
                }
            } else {
                switch(currentCipher) {
                    case 'meow':
                        result = decrypt(text);
                        break;
                    case 'dynasty':
                        result = dynastyDecrypt(text);
                        break;
                    case 'morse':
                        result = morseDecrypt(text);
                        break;
                    case 'base64':
                        result = base64Decrypt(text);
                        break;
                    case 'aes':
                        result = aesDecrypt(text, key);
                        break;
                }
            }
            
            resultText.value = result;
            outputLength.textContent = result.length;
            
            const endTime = performance.now();
            processTime.textContent = `${(endTime - startTime).toFixed(2)}ms`;
            
            showFeedback(`${currentMode === 'encrypt' ? '加密' : '解密'}成功!`);
        });

        clearBtn.addEventListener('click', () => {
            inputText.value = '';
            resultText.value = '';
            keyInput.value = '';
            inputLength.textContent = '0';
            outputLength.textContent = '0';
            inputText.focus();
            showFeedback('已清空内容');
        });

        copyBtn.addEventListener('click', () => {
            if (resultText.value) {
                resultText.select();
                document.execCommand('copy');
                
                // 显示复制成功反馈
                const originalText = copyBtn.innerHTML;
                copyBtn.innerHTML = '<i class="fas fa-check"></i> 已复制';
                copyBtn.classList.add('success');
                
                // 添加动画效果
                copyBtn.style.transform = 'scale(1.05)';
                setTimeout(() => {
                    copyBtn.style.transform = 'scale(1)';
                }, 300);
                
                setTimeout(() => {
                    copyBtn.innerHTML = originalText;
                    copyBtn.classList.remove('success');
                }, 2000);
            }
        });

        function showFeedback(message) {
            const feedback = document.createElement('div');
            feedback.textContent = message;
            feedback.style.position = 'fixed';
            feedback.style.bottom = '20px';
            feedback.style.right = '20px';
            feedback.style.background = 'rgba(0,0,0,0.7)';
            feedback.style.color = 'white';
            feedback.style.padding = '10px 20px';
            feedback.style.borderRadius = '5px';
            feedback.style.zIndex = '1000';
            feedback.style.fontSize = '1rem';
            document.body.appendChild(feedback);
            
            setTimeout(() => {
                feedback.style.opacity = '0';
                setTimeout(() => {
                    document.body.removeChild(feedback);
                }, 300);
            }, 2000);
        }

        // 初始焦点在输入框
        inputText.focus();
        updateCipherDescription();
    </script>
</body>
</html>
